<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="question-profile">
  <template>   

    <link rel="stylesheet" href="../../css/enquetepage.css">
    <link rel="import" href="../../bower_components/font-roboto/roboto.html">
    <link rel="import" href="../../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
    <link rel="import" href="../../bower_components/iron-fit-behavior/iron-fit-behavior.html">
    
    <link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
    <iron-ajax 
     id="accountPost"
       method="POST"
       handleAs="json"
       content-type='application/json'>
    </iron-ajax>
    
    <div class="vertical layout middlePanel card" style="position:relative; top:180px;">
      <div class="vertical layout center">
        <iron-image class="clipContainer" width="180" height="74" src="../../images/LogoBlauwSmall.png">
        </iron-image>
      </div>
      <div class="vertical layout center" style="position: relative; top: -75px;">
        <p class="blockTitleText" style="margin-bottom: 0px;">Hier volgen een aantal vragen om je profielgegevens aan te vullen.</p>

        <div class="vertical layout center" style="padding:60px;">
          <p class="questionText">Wie ben jij?</p>
          <div class="horizontal layout center">
            <paper-input id="name" label="Voornaam" on-change="checkButtonState"></paper-input>
            <div style="width:30px;"></div>
            <paper-input id="surname" label="Achternaam" on-change="checkButtonState"></paper-input>
          </div>
        </div>

        <div class="vertical layout center">
          <div class="seperator"></div>    
        </div>

        <div class="vertical layout center" style="padding:60px;">
          <p class="questionText">Je bent</p>
          <div id="geslacht" class="horizontal layout center">
            <span class="questionElementText">een man</span>
            <div>
              <div id="iconContainer" class="horizontal layout" style="margin: 10px;">
                <span id="1" class="qBigIcon" on-click='bigIconSelector'></span>
                <div style="width:5px;"></div>
                <span id="2" class="qBigIcon" on-click='bigIconSelector'></span>
              </div>
            </div>
            <span class="questionElementText">een vrouw</span>
          </div>
        </div>

        <div class="vertical layout center">
          <div class="seperator"></div>    
        </div>

        <div id="leeftijd" class="vertical layout center" style="padding:60px;">
          <p class="questionText">Je leeftijd is</p>
           <div id="iconContainer" class="vertical layout">
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="0" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 16 en 20 jaar</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="1" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 21 en 30 jaar</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="2" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 31 en 40 jaar</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="3" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 41 en 50 jaar </p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="4" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 51 en 60 jaar</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="5" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">tussen 61 en 70 jaar</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="6" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">ouder dan 71 jaar</p>
            </div>
          </div>
        </div>

        <div class="vertical layout center">
          <div class="seperator"></div>    
        </div>

        <div id="opleiding" class="vertical layout center" style="padding:60px;">
          <p class="questionText">Je hoogst genoten opleiding (afgerond)</p>
           <div id="iconContainer" class="vertical layout">
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="0" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">HAVO</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="1" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">VWO</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="2" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">MBO</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="3" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">HBO</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="4" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">WO</p>
            </div>
          </div>
        </div>

        <div class="vertical layout center">
          <div class="seperator"></div>    
        </div>

        <div id="plaats" class="vertical layout center" style="padding:60px;">
          <p class="questionText">Je bent opgegroeid in</p>
           <div id="iconContainer" class="vertical layout">
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="0" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Groningen</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="1" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Friesland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="2" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Drenthe</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="3" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Overijssel</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="4" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Flevoland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="5" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Limburg</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="6" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Noord-Brabant</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="7" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Noord-Holland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="8" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Zuid-Holland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="9" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Zeeland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="10" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Utrecht</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="11" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">BelgiÃ«</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="12" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Duitsland</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="13" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Frankrijk</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="14" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Verenigd-Koninkrijk</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="15" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">Luxemburg</p>
            </div>
            <div class="horizontal layout center" style="margin: 10px;">
              <span id="16" class="qBigIcon" on-click="bigIconSelector"></span>
              <p class="questionElementText" style="margin-left: 10px;">andere</p>
            </div>
          </div>
        </div>
      </div>
      <div class="vertical layout center buttonContainer">
        <div class="horizontal layout center">
          <link rel="import" href="../jr-button-outline/jr-button-outline.html">
          <jr-button-outline id="finishButton" disabled="true" icon="done" on-click="done"></jr-button-outline>    
        </div> 
        <div style="height:30px;"></div> 
      </div>
    </div>
  </template>

</dom-module>
<script>

  Polymer({
    is: "question-profile",

    properties: {
      user: {
        type: String
      }
    },
    created: function(){
      this.geslachten = ["M","V"];
      this.leeftijden = ["16", "21", "31", "41", "51", "61", "71"];
      this.opleidingen = ["HA", "VW", "MB", "HB","WO"];
      this.plaatsen = ["GR", "FR", "DR","OV","FL","LI","NO","NO","ZU","ZE","UT","BE","DU","FA","VE","LU","AN"];
      this.counter = [false, false, false, false];
    },

    done: function(){
      var data = JSON.stringify({"user": this.user ,"first_name": this.$.name.value, "last_name": this.$.surname.value, "provincie": this.plaats, "geslacht": this.geslacht, "opleiding":this.opleiding, "leeftijd":this.leeftijd});
      console.log(data);
      this.$.accountPost.headers = {
            "X-CSRFToken": this.getCSRFCookie(),
            "X-Requested-With": "XMLHttpRequest"
        };
      this.$.accountPost.url = "/api/accounts/"
      this.$.accountPost.body = data;
      this.$.accountPost.generateRequest();
      document.getElementById("profileOverlay").style.display = "none";
    },
    getCSRFCookie: function() {
        b = document.cookie.match('(^|;)\\s*csrftoken\\s*=\\s*([^;]+)');
        return b ? b.pop() : '';
    },
    bigIconSelector: function(sender){
      var elementList = sender.toElement.parentNode.parentNode.querySelectorAll("span");
      for (i = 0; i < elementList.length; i++){
        if (sender.toElement.id == elementList[i].id){
          elementList[i].className = "qSelectedBigIcon";
          var question = sender.toElement.parentNode.parentNode.parentNode.id;
          if(question == "geslacht"){
            this.counter[0] = true;
            this.geslacht = this.geslachten[i];
          }
          else if(question == "leeftijd"){
            this.leeftijd = this.leeftijden[i];
            this.counter[1] = true;
          }
          else if(question == "opleiding"){
            this.opleiding = this.opleidingen[i];
            this.counter[2] = true;
          }
          else if(question == "plaats"){
            this.plaats = this.plaatsen[i];
            this.counter[3] = true;
          }
          this.checkButtonState();
        }
        else{
          elementList[i].className = "qBigIcon";
        }
      }
    },
    checkButtonState: function(){
      if (this.counter[0] && this.counter[1] && this.counter[2] && this.counter[3] && this.$.name.value != "" && this.$.surname.value != ""){
        this.$.finishButton.disabled = false;
      }
    }

  });
</script>